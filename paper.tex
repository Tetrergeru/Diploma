\documentclass[14pt]{mmcs-article}
\usepackage[russian]{babel}
\usepackage{amsmath, amsthm, amsfonts, amssymb}

% После кванторов ставить отступ
% Починить \mod (\mathsc) -- сейчас там большой пробел в начале

% Надо бы настроить правильную сквозную нумерацию замечаний, теорем e.t.c

\graphicspath{{paper_images/}}

\begin{document}

\include{TitulMag}

\renewcommand{\contentsname}{Оглавление}

\tableofcontents

\newpage

\addcontentsline{toc}{section}{Введение}
\section*{Введение}

В описании современных стандартов передачи данных много внимания уделено контролю ошибок, неизбежно возникающими в любом канале связи. В теории кодирования применяют много различных подходов к проблеме коррекции подобных ошибок. Обычно для этого вместе с последовательностью данных передают последовательность проверочных битов, которые позволяют обнаружить и исправить ошибочно переданные сигналы. Примером таких алгоритмов могут служить алгоритм декодирования Земора \cite{zemor} и LDPC-коды \cite{johnson}.

Впервые LDPC-коды были описаны в работе Роберта Галагера \cite{gallager} в 1963 году, однако не применялись до 1996 года, из-за сложностей в реализации кодеров и декодеров.

LDPC-коды вошли в стандарт цифорвого спутникового вещания\\ DVB-S2, разработанный в 2003 году международным консорциумом DVB Project. Также LDPC коды включены в стандарты Ethernet 10GBASE-T и Wi-Fi 802.11.

Передача данных через канал с шумами осуществляется следующим образом: поток данных разбивают на блоки определённой длины, вместе с данными передаётся набор проверочных блоков, построенных на основе информационных блоков. Принимающая стороная использует проверочные блоки, чтобы убедиться в целостности данных в информационных блоках или  восстановить допущенные ошибки, насколько это возможно.

Значение проверочных блоков вычисляется с помощью графа Таннера: часть вершин соответствуют информационным блокам, другие ~--- проверочным блокам. Значение проверочного блока равно сумме значений связанных с ними информационных блоков. От того, какими свойствами обладает используемый граф Таннера сильно зависит эффективность работы алгоритма LDPC. Поэтому активно ведутся исследования в области поиска методов построения графов Таннера с требуемыми параметрами.

Методы построения таких графов, используемые в крупных компаниях, попадают под соглашения о неразглашении. Однако известны две основные группы методов: случайные, основанные на генерации начального графа случайным способом, например перебор возможных матриц \cite{bruteforce} и псевдослучайные пермутации матриц \cite{gallager}; и структурированные, основанные на построении графа с определённой, заранее известной структурой, например методы, использующие протографы \cite{protographs}.

Эмпирически показано, что лучшие результаты показывают графы, построенные случайными методами, однако структурированные методы позволяют получать коды с более предсказуемыми характеристиками, а так же оптимизировать хранение графов. 

В данной работе рассматриваются некоторые структурированные методы построения графов Таннера с заданными свойствами.

%=======================
\newpage
\addcontentsline{toc}{section}{Постановка задачи}

\section*{Постановка задачи}

В современных протоколах кодирования активно применяются граффы Таннера со специфичными свойствами. Ставится задача построения таких графов. Для этого требуется:

\begin{itemize}
  \item Изучить двудольные графы с регулярной структурой, разработать методы упрощённого представления таких графов.
  \item Разработать алгоритмы быстрого поиска циклов минимальной длины на графах с регулярной структурой.
  \item Рассмотреть задачу построения регулярного графа Таннера с заданным обхватом. Разработать алгоритм построения таких графов.
  \item Разработать метод построения регулярных графов Таннера на основе метаграфов.
\end{itemize}

%=======================
\newpage
\section{Основные понятия и утверждения}

\textbf{Определение 1.}

% Надо потом аккуратно в замечении это всё дело переопределить так, чтобы запись была более компактная (отказаться от отображения, использовать пары)

\textsl{Двудольным графом} будем называть тройку $ G(V, E, f)$, такую, что:

\begin{itemize}
    \item $V = A \cup B$ и $A \cap B = \emptyset$ ;
    % Возможно надо использовать неупорядоченное декартово произведение, о том как это лучше сделать, надо смотреть в книжке Зыкова
    \item $f: E \rightarrow A \times B$ ;
\end{itemize}

Где $V$ ~-- множество вершин, разбитое на два непересекающихся подмножества $A$ и $B$.
$E$ ~-- множество дуг.
$f$ ~-- это отображение, определяющее то, с какими вершинами инцидентна дуга.

\textbf{Определение 2.}

Последовательность дуг $\mu = (e_1, ..., e_d)$ будем называть путём с начальной вершиной $v_0$ и конечной вершиной $v_d$  на графе $G(V,E,f)$, если существует последовательность вершин $(v_0, ..., v_d)$ такая, что $\forall i = 1,...,d:$ $(v_i, v_{i+1}) = f(e_i)$ или $(v_{i+1}, v_i) = f(e_i)$. 

% Пронумеровать вершины

Рассмотрим граф на рис \ref{image:1}. Последовательность дуг $(e_1, e_2, e_4, e_6)$ составляет путь с начальной вершиной C и конечной вершиной E.

\begin{figure}[H]
    \centering
    \begin{picture}(220,200)
        \put(75,165){\thicklines{\circle*{5}}}
        \put(70,170){$c_1$}
        \put(35,35){\thicklines{\circle*{5}}}
        \put(30,20){$i_1$}
        \put(115,35){\thicklines{\circle*{5}}}
        \put(110,20){$i_2$}

        \thicklines
        \bezier{300}(75,165)(56,100)(35,35)
        \put(40,100){$e_1$}
        \bezier{300}(75,165)(94,100)(115,35)
        \put(80,100){$e_2$}
        \bezier{300}(175,165)(120,100)(115,35)
        \put(135,130){$e_4$}
        \bezier{300}(175,165)(194,100)(135,35)
        \put(165,60){$e_6$}

        \thinlines
        \bezier{300}(75,165)(130,100)(135,35)
        \put(105,130){$e_3$}

        \put(175,165){\thicklines{\circle*{5}}}
        \put(170,170){$c_1$}
        \put(135,35){\thicklines{\circle*{5}}}
        \put(130,20){$i_1$}
        \put(215,35){\thicklines{\circle*{5}}}
        \put(210,20){$i_2$}

        \bezier{300}(175,165)(156,100)(135,35)
        \put(140,100){$e_5$}
        \bezier{300}(175,165)(195,100)(215,35)
        \put(200,100){$e_7$}
    \end{picture}
    \caption{ Двудольный граф. }\label{image:1}
\end{figure}

\textbf{Определение 4.}

\textsl{Циклом} будем называть путь, у которого совпадают первая и последняя вершины.

\textbf{Определение 6.}

\textsl{Обхватом графа} называют длину его минимального цикла.

\textbf{Замечание 1.}

Отметим, что обхват любого двудольного графа является чётным числом

% большим, чем два.

\textbf{Замечание 2.}

Известно, что на практике для кодирования эффективнее использовать графы с большим обхватом.

\textbf{Определение 5.}

% Характеристика дуги внутри пути (в какую сторону путь проходит дугу)

С каждым путём $\mu$ свяжем характеристическую функцию $\chi_\mu(e)$:
\[
    \begin{array}{ll}
        \chi_{\mu}(e_1) = \left\{
            \begin{array}{ll}
            1,  & v_0 \in A;\\
            -1, & v_0 \in B. \\
            \end{array}
        \right. \\
        \chi_\mu(e_i) = -\chi_\mu(e_{i-1}) \forall i \in 2, ..., d\\
    \end{array}
\]

\newpage
\section{Метаграфы}

\textbf{Определение 6.}

Если $G(V,E,f)$ ~-- двудольный граф, то \textsl{Метаграфом} будем называть четвёрку $G'(V,E,f,w)$, где $w: E \to \mathbb{Z}$ ~-- отображения, задающее веса дуг

На рис. \ref{image:2} представлен метаграф  $G_1$ с тремя вершинами и четырьмя дугами.

\begin{figure}[H]
    \centering
    \begin{picture}(150,200)
        \put(75,165){\thicklines{\circle*{5}}}
        \put(70,170){$c_1$}
    
        \put(35,35){\thicklines{\circle*{5}}}
        \put(30,20){$i_1$}
    
        \put(115,35){\thicklines{\circle*{5}}}
        \put(110,20){$i_2$}
    
        \bezier{300}(75,165)(10,100)(35,35)
        \put(5,100){$+1$}

        \bezier{300}(75,165)(56,100)(35,35)
        \put(56,80){$0$}
    
        \bezier{300}(75,165)(140,100)(115,35)
        \put(125,100){$-1$}

        \bezier{300}(75,165)(94,100)(115,35)
        \put(87,80){$0$}
    \end{picture}
    \caption{ Метаграф с весами дуг +1, 0, 0, -1.. }
    \label{image:2}
\end{figure}

\textbf{Определение 7.}

Пусть $r \in \mathbb{N}$, тогда $r$-расширением метаграфа $G'(V,E,f,w)$ назовём граф $G^{(r)}(V^{(r)}, E^{(r)}, f^{(r)})$ построенный следующим образом:

\begin{itemize}
    \item Каждой вершине $v \in V$ соответствует множество вершин
    \[
        T^{(r)}(v) = \{ v^{(1)}, ..., v^{(r)} \}
    \]

    \item Тогда множество вершин метаграфа устроено следующим образом 
    \[
        V^{(r)} = \bigcup_{v \in V} T^{(r)}(v)
    \]

    \item Каждой дуге $e \in E$ соответствует множество дуг 
    \[
        T^{(r)}(e) = \{ e^{(1)}, ..., e^{(r)} \}
    \]

    \item Тогда множество дуг метаграфа устроено следующим образом
    \[
        E^{(r)} = \bigcup_{e \in E}T^{(r)}(e)
    \]

    \item Пусть $f(e) = (a, b)$, тогда $f^{(r)}(e^{(i)}) = (a^{(i)}, b^{(i + w(e) (\mod{r}))}) \forall i = 1,...,r$
\end{itemize}

На рис. \ref{image:3} изображён граф, полученный 4-расширением метаграфа $G_1$, изображённого на рис. \ref{image:2}.
% Пример нужен, чтобы показать, что на метаграфах с кратными дугами яразу появляются маленькие циклы

\begin{figure}[H]
    \centering
    \begin{picture}(450,200)
        \put(75,165){\thicklines{\circle*{5}}}
        \put(70,170){$c_1$}
        \put(35,35){\thicklines{\circle*{5}}}
        \put(30,20){$i_1$}
        \put(115,35){\thicklines{\circle*{5}}}
        \put(110,20){$i_2$}

        \bezier{300}(75,165)(56,100)(35,35)
        \bezier{300}(75,165)(94,100)(115,35)
        \bezier{300}(75,165)(130,100)(135,35)
        \bezier{300}(175,165)(120,100)(115,35)

        \put(175,165){\thicklines{\circle*{5}}}
        \put(170,170){$c_1$}
        \put(135,35){\thicklines{\circle*{5}}}
        \put(130,20){$i_1$}
        \put(215,35){\thicklines{\circle*{5}}}
        \put(210,20){$i_2$}

        \bezier{300}(175,165)(156,100)(135,35)
        \bezier{300}(175,165)(194,100)(215,35)
        \bezier{300}(175,165)(230,100)(235,35)
        \bezier{300}(275,165)(220,100)(215,35)


        \put(275,165){\thicklines{\circle*{5}}}
        \put(270,170){$c_1$}
        \put(235,35){\thicklines{\circle*{5}}}
        \put(230,20){$i_1$}
        \put(315,35){\thicklines{\circle*{5}}}
        \put(310,20){$i_2$}

        \bezier{300}(275,165)(256,100)(235,35)
        \bezier{300}(275,165)(294,100)(315,35)
        \bezier{300}(275,165)(330,100)(335,35)
        \bezier{300}(375,165)(320,100)(315,35)


        \put(375,165){\thicklines{\circle*{5}}}
        \put(370,170){$c_1$}
        \put(335,35){\thicklines{\circle*{5}}}
        \put(330,20){$i_1$}
        \put(415,35){\thicklines{\circle*{5}}}
        \put(410,20){$i_2$}

        \bezier{300}(375,165)(356,100)(335,35)
        \bezier{300}(375,165)(394,100)(415,35)

        \bezier{700}(75,165)(245,100)(415,35)
        \bezier{700}(375,165)(205,100)(35,35)
    \end{picture}
    \caption{ Метаграф с весами дуг +1, 0, 0, -1.. }
    \label{image:3}
\end{figure}

\textbf{Теорема 1.} \textsl{(О начальных вершинах путей)}

Пусть $\eta = (e_1, \dots, e_d)$ ~-- путь с начальной вершиной $v$ на метаграфе $G$, тогда на графе $G^{(r)}$ существуют $r$ попарно не пересекающихся путей $\mu_1 \dots \mu_r$ с начальными вершинами $v^{(1)}, ..., v^{(r)}$, таких что для каждого пути $\mu'=(e_1',\dots,e_d') \in\{\mu_1,\dots,\mu_r\}$ справедливо, что для всех $j\in[1;d]_N$ $e_{j}' \in T^{(r)}(e_j)$.

\textbf{Доказательство.}

% Skorokhodov V.A. Generalization of the Reachability Problem on Directed Graphs/ Mathematics and Statistics, Vol. 8, No. 6, pp. 699 - 704, 2020. DOI: 10.13189/ms.2020.080610

Следует из определения расширения метаграфа.

\qed

\textbf{Определение 8.}

Будем говорить, что пути $\eta$ на метаграфе $G$ соответствуют пути $\mu_i$ на графе $G^{(r)}$ и наоборот.

\textbf{Замечание 2.}

Из того, что некоторый путь на метаграфе $G$ является циклом не следует, что соответствующие ему пути на $G^{(r)}$ являются циклами. Рассмотрим эту ситуацию на следующем примере.

\textbf{Пример 1.}

Рассмотрим граф на рис. \ref{image:4}. Путь $(e_1, e_2)$ является циклом на метаграфе, однако ни один из соответствующих ему путей $\mu_1 = (e^{(1)}_1, e^{(1)}_2)$, $\mu_2 = (e^{(2)}_1, e^{(2)}_2)$, $\mu_3 = (e^{(3)}_1, e^{(3)}_2)$  на 3-расширении не является циклом. При этом следует отметить, что склейка этих трёх путей порождает цикл $\mu = (e^{(1)}_1, e^{(1)}_2, e^{(2)}_1, e^{(2)}_2, e^{(3)}_1, e^{(3)}_2)$ длины 6. Заметим, что циклу $\mu$ соответствует цикл $(e_1, e_2, e_1, e_2, e_1, e_2)$ на метаграфе.

\begin{figure}[H]
    \centering
    \begin{picture}(255,200)
        \put(0,165){$a.$}

        \put(35,165){\thicklines{\circle*{5}}}
        \put(30,170){$A$}
        \put(35,35){\thicklines{\circle*{5}}}
        \put(30,20){$B$}
    
        \bezier{300}(35,165)(10,100)(35,35)
        \put(0,100){$e_1$}
        \bezier{300}(35,165)(60,100)(35,35)
        \put(56,100){$e_ 2$}



        \put(110,165){$b.$}

        \put(145,165){\thicklines{\circle*{5}}}
        \put(140,170){$A^{(1)}$}
        \put(145,35){\thicklines{\circle*{5}}}
        \put(140,20){$B^{(1)}$}

        \thicklines
        \bezier{300}(145,165)(145,100)(145,35)
        \put(125,130){$e_0^{(1)}$}

        \bezier{300}(145,165)(165,100)(185,35)
        \put(147,85){$e_1^{(1)}$}
        \thinlines

        \put(185,165){\thicklines{\circle*{5}}}
        \put(180,170){$A^{(2)}$}
        \put(185,35){\thicklines{\circle*{5}}}
        \put(180,20){$B^{(2)}$}

        \bezier{300}(185,165)(185,100)(185,35)
        \put(165,130){$e_0^{(2)}$}
        
        \bezier{300}(185,165)(205,100)(225,35)
        \put(187,85){$e_1^{(2)}$}

        \put(225,165){\thicklines{\circle*{5}}}
        \put(220,170){$A^{(3)}$}
        \put(225,35){\thicklines{\circle*{5}}}
        \put(220,20){$B^{(3)}$}

        \bezier{300}(225,165)(225,100)(225,35)
        \put(205,130){$e_0^{(3)}$}

        \bezier{300}(225,165)(232,50)(145,35)
        \put(190,45){$e_1^{(3)}$}
    \end{picture}
    \caption{ a. Метаграф. b. 3-расширение метаграфа. }
    \label{image:2}
\end{figure}

\textbf{Определение 7.}

Пусть $G(V, E, f, w)$ ~-- метаграф.

Характеристикой пути $\eta = (e_1, ..., e_d)$ будем называть

\[
    \chi(\eta) = \sum_{i = 1}^d \chi_{\eta}(e_i) w(e_i).
\]

\textbf{Теорема 2.}\textsl{(О конечных вершинах путей)}

Пусть  $\eta = (e_1, ..., e_d)$ ~-- путь на метаграфе $G$, его первая вершина ~-- $x$, а последняя вершина ~-- $y$. И пусть $\mu' = (e'_1, ..., e'_d)$ один из соответствующих ему путей на расширенном графе.

Тогда если у $\mu'$ начальная вершина $x^{(i)}$, то его последняя вершина ~-- $y^{(i + \chi(\eta)\mod{r})}$.

\textbf{Доказательство.}

% Как-то лучше мы это переписывали, а то просто месиво символов получается. Может там чуть ли не на "очевидно" можно было заменить

Доказательство проведём по индукции по длине пути $|\eta| = d$.

Пусть $d = 1$, тогда путь состоит их одной дуги $e_1$.

Если $x \in A$, тогда вершина $x^{(i)}$ инцидентна дуге $e_1'$, для которой $f^{(r)}(e_1') = (x^{(i)}, y^{(i + w(e_1) (\mod{r}))})$ то есть, конечной вершиной пути $\mu_i$ является $y^{(i + w(e_1) (\mod{r}))} = y^{(i + \chi(\eta) (\mod{r}))}$.

Если $x \in B$, тогда вершина $x^{(i)}$ инцидентна дуге $e_1'$, для которой $f^{(r)}(e_1') = (y^{(i - w(e_1) (\mod{r}))}, x^{(i)})$ то есть, конечной вершиной пути $\mu_i$ является $y^{(i - w(e_1) (\mod{r}))} = y^{(i + \chi(\eta) (\mod{r}))}$.

Пусть условия теоремы выполняются для всякого $d < n$, тогда рассмотрим случай $d = n$.

Рассмотрим путь $\eta' = (e_1, ..., e_{d - 1})$. Обозначим его последнюю вершину $x$. Тогда по предположению индукции последние вершины соответствующих ему путей на метаграфе ~-- это $x^{(i + \chi(\eta')(\mod{r}))}$.

Если $x \in A$, тогда вершина $x^{(i + \chi(\eta')(\mod{r}))}$ инцидентна дуге \\ $f^{(r)}(e_d^{(i + \chi(\eta')(\mod{r}))}) = (x^{(i + \chi(\eta')(\mod{r}))}, y^{(i + \chi(\eta') + w(e_d) (\mod{r}))})$ и конечная \\ вершина пути $\mu_i$ ~-- $y^{(i + \chi(\eta') + w(e_d) (\mod{r}))} = y^{(i + \chi(\mu) (\mod{r}))}$.

Если $x \in B$, тогда вершина $x^{(i + \chi(\eta')(\mod{r}))}$ инцидентна дуге \\ $f^{(r)}(e_d^{(i + \chi(\eta') - w(e_d) (\mod{r}))}) = (y^{(i + \chi(\eta') - w(e_d) (\mod{r}))}, x^{(i)})$ и конечная вершина пути $\mu_i$ ~-- $y^{(i + \chi(\eta') - w(e_d) (\mod{r}))} = y^{(i + \chi(\mu) (\mod{r}))}$.

\qed

Важными следствиями из Теоремы 2 являются две следующих теоремы.

\textbf{Теорема 3.} \textsl{(О циклах)}

Пусть $\eta$ ~-- цикл на метаграфе. Тогда соответствующие ему пути на расширенном графе являются циклами тогда и только тогда, когда $\chi(\eta) = 0 (\mod{r})$.

\textbf{Теорема 4.} \textsl{(О <<крыльях>> цикла)}

Пусть $\eta = (e_1, ..., e_d)$ и $\mu = (\epsilon_1, ..., \epsilon_{\delta})$ ~-- различные пути на метаграфе с начальной вершиной $a$, конечной вершиной $b$ и $\chi(\eta) = \chi(\mu) (\mod{r})$. Тогда путь на расширении, соответствующий склейке этих путей \\ $\gamma = (e_1, \dots, e_d, \epsilon_{\delta}, \dots, \epsilon_1)$, является циклом.

Эти теоремы дают метод нахождения циклов на расширенном графе, описываемый следующим алгоритмом:

%%%%%%%%% Всё что выше не переписываем (пока что)

\textbf{Алгоритм 1.}

Поиска цикла с длинной меньше или равной заданному чётному числу $l \in \mathbb{N}$.

Пусть $G(A \cup B, E, f, w)$ ~-- метаграф и задано $r \in \mathbb{N}$.

Алгоритм основан на заполнении множества меток для вершин метаграфа. Каждая метка представляет собой четвёрку $(g, v, ch, p)$, где $g$ ~-- длина пути $\mu$ пройденного от начальной до помечаемой вершины, далее $g$ будем называть поколением метки; $v$ ~-- вершина, которая помечена этой меткой; $ch \in \mathbb{Z}$ ~-- характеристика метки, обозначает характеристику пути $\mu$; $p \in V \cup \{ nil \}$ ~-- дуга, на основе которой была сгенерирована метка, при обработке предыдущего поколения меток, где $nil \not\in V $ ~-- специальное значение, зарезервированное для исходной метки.

\begin{itemize}

\item Для каждой вершины $a \in A:$

\begin{itemize}
    \item Добавим метку $(0, a, 0, nil)$ в пустое множество всех меток
    \item В цикле по поколениям $g$ от $1$ до $l / 2$:
    \begin{itemize}
        \item Для всех меток вида $(g - 1, v, ch, p)$:
        \item
            Для каждой дуги $e \not= p$ инцидентной вершине $v$,
            формируем метку $(g, v', ch', e)$, где $ch' = ch + (-1)^{g} w(e) (\mod{r})$, $v'$ ~-- вершина отличная от $v$, инцидентная $e$.
            Добавляем эту метку ко множеству всех меток.
    \end{itemize}
    \item Если существуют хотя бы две метки с совпадающими вторым и третьим элементами, сообщаем о том, что обнаружен цикл и завершаем работу алгоритма.
\end{itemize}

\item Сообщаем о том, что цикл не найден.
\end{itemize}

\textbf{Пример 2.}

% Возможно лучше разделить на два отедельынх рисунка и ссылаться по отдельности

Рассмотрим этапы поиска цикла на метаграфе, изображённом на рис. \ref{cycle_search}, с помощью алгоритма 1. В таблице \ref{cycle_search_table} приведено множество меток, сгенерированных алгоритмом для начальной вершины $v_1$, сгруппированное в столбцы по поколению.

\begin{figure}[H]
    \centering
    \begin{picture}(170,200)
        \put(35,165){\thicklines{\circle*{5}}}
        \put(30,170){$v_1$}
        \put(115,165){\thicklines{\circle*{5}}}
        \put(110,170){$v_2$}

        \put(35,35){\thicklines{\circle*{5}}}
        \put(30,20){$v_3$}
        \put(115,35){\thicklines{\circle*{5}}}
        \put(110,20){$v_4$}

        \bezier{300}(35,165)(-10,100)(35,35)
        \put(0,100){$a$}
        \bezier{300}(35,165)(35,100)(35,35)
        \put(40,100){$b$}
        \bezier{300}(35,165)(70,100)(115,35)
        \put(60,130){$c$}

        \bezier{300}(115,165)(115,100)(115,35)
        \put(120,100){$e$}
        
        \bezier{300}(115,165)(70,100)(35,35)
        \put(80,130){$d$}
    \end{picture} \\
    \begin{tabular}{ | c | c | }
        \hline
        $e$ & $w(e)$ \\ \hline
        $a$ & $-1$   \\
        $b$ & $0$    \\
        $c$ & $+1$   \\
        $d$ & $0$    \\
        $e$ & $0$    \\ \hline
    \end{tabular}
    \caption{ Пример метаграфа. }\label{cycle_search}
\end{figure}

В поколении 3 есть метки $(3, v_4,  0, c)$ и $(3, v_4,  0, e)$, у которых совпадают второй и третий элементы. Следовательно, цикл найден. Отметим, что длина этого цикла на расширении метаграфа равна $6$ ~-- сумме поколений этих двух меток. 

\begin{table}[H]
    \centering
    \begin{tabular}{ | c | c | c | c | }
        \hline
        $g = 0$            & $g = 1$           & $g = 2$           & $g = 3$ \\ \hline
        $(0, v_1, 0, nil)$ & $(1, v_3,  0, b)$ & $(2, v_1,  4, b)$ & $(3, v_3,  3, a)$ \\ \hline
                           & $(1, v_3,  4, a)$ & $(2, v_1,  1, a)$ & $(3, v_4,  0, c)$ \\ \hline
                           & $(1, v_4,  1, c)$ & $(2, v_2,  1, e)$ & $(3, v_3,  0, a)$ \\ \hline
                           &                   & $(2, v_2,  0, d)$ & $(3, v_4,  2, c)$ \\ \hline
                           &                   & $(2, v_2,  4, d)$ & $(3, v_3,  1, d)$ \\ \hline
                           &                   &                   & $(3, v_4,  0, e)$ \\ \hline
                           &                   &                   & $(3, v_4,  4, e)$ \\ \hline
    \end{tabular}
    \caption{ Множество меток, сгенерированное в процессе работы алгоритма поиска цикла на метаграфе. }
    \label{cycle_search_table}
\end{table}

На рис. \ref{cycle_search_expanded} изображено 5-расширение метаграфа изображённого на рис. \ref{cycle_search}. Цикл, соответствующий найденному в ходе работы алгоритма выделен пунктиром. % (Когда будет конечная версия рисунка -- заменить)

\begin{figure}[H]
    \centering
    \begin{picture}(360,200)
        \put(35,165){\thicklines{\circle*{5}}}
        \put(65,165){\thicklines{\circle*{5}}}
        \put(35,35){\thicklines{\circle*{5}}}
        \put(65,35){\thicklines{\circle*{5}}}

        \bezier{300}(35,165)(35,100)(35,35)
        \bezier{300}(65,165)(65,100)(65,35)
        \bezier{300}(65,165)(50,100)(35,35)

        \bezier{300}(35,165)(85,100)(135,35)
        \bezier{300}(105,165)(70,100)(35,35)

        \put(105,165){\thicklines{\circle*{5}}}
        \put(135,165){\thicklines{\circle*{5}}}
        \put(105,35){\thicklines{\circle*{5}}}
        \put(135,35){\thicklines{\circle*{5}}}

        \bezier{300}(105,165)(105,100)(105,35)
        \bezier{300}(135,165)(135,100)(135,35)
        \bezier{300}(135,165)(120,100)(105,35)

        \bezier{300}(105,165)(155,100)(205,35)
        \bezier{300}(175,165)(140,100)(105,35)

        \put(175,165){\thicklines{\circle*{5}}}
        \put(205,165){\thicklines{\circle*{5}}}
        \put(175,35){\thicklines{\circle*{5}}}
        \put(205,35){\thicklines{\circle*{5}}}

        \bezier{300}(175,165)(175,100)(175,35)
        \bezier{300}(205,165)(205,100)(205,35)
        \bezier{300}(205,165)(190,100)(175,35)

        \bezier{300}(175,165)(225,100)(275,35)
        \bezier{300}(245,165)(210,100)(175,35)

        \put(245,165){\thicklines{\circle*{5}}}
        \put(275,165){\thicklines{\circle*{5}}}
        \put(245,35){\thicklines{\circle*{5}}}
        \put(275,35){\thicklines{\circle*{5}}}

        \bezier{300}(245,165)(245,100)(245,35)
        \bezier{300}(275,165)(275,100)(275,35)
        \bezier{300}(275,165)(260,100)(245,35)

        \bezier{300}(245,165)(295,100)(345,35)
        \bezier{300}(315,165)(280,100)(245,35)

        \put(315,165){\thicklines{\circle*{5}}}
        \put(345,165){\thicklines{\circle*{5}}}
        \put(315,35){\thicklines{\circle*{5}}}
        \put(345,35){\thicklines{\circle*{5}}}

        \bezier{300}(315,165)(315,100)(315,35)
        \bezier{300}(345,165)(345,100)(345,35)
        \bezier{300}(345,165)(330,100)(315,35)

        \bezier{700}(315,165)(65,275)(65,35)
        \bezier{700}(315,165)(35,325)(35,35)
    \end{picture}
    \caption{ 5-расширение метаграфа. }\label{cycle_search_expanded}
\end{figure}


\textbf{Замечание.}

Если в алгоритме 1.  учитывать совпадающие характеристики только пометок в текущем поколении, ты будут найдены только циклы состоящие из двух <<крыльев>> одинаковой длины, однако любой цикл на метаграфе представим в таком виде, следовательно будут найдены все циклы.

\textbf{Пример 3.}

Рассмотрим ещё один пример работы алгоритма на рис. \ref{cycle_mod_search}. В верхней части рисунка изображён метаграф $G$ с пометками, оставленными алгоритмом поиска циклов. В нижней части рисунка изображено 5-расширение метаграфа $G$, на котором помечен найденный цикл, который проходит по кругу через весь граф.

\begin{figure}[H]
    \centering
    % \begin{hbox}
    \begin{picture}(170,200)
        \put(35,165){\thicklines{\circle*{5}}}
        \put(30,170){$v_1$}
        \put(115,165){\thicklines{\circle*{5}}}
        \put(110,170){$v_2$}

        \put(35,35){\thicklines{\circle*{5}}}
        \put(30,20){$v_3$}
        \put(115,35){\thicklines{\circle*{5}}}
        \put(110,20){$v_4$}

        \bezier{300}(35,165)(35,100)(35,35)
        \put(40,100){$a$}
        \bezier{300}(35,165)(75,100)(115,35)
        \put(60,130){$b$}

        \bezier{300}(115,165)(75,100)(35,35)
        \put(80,130){$c$}
        \bezier{300}(115,165)(115,100)(115,35)
        \put(120,100){$d$}
    \end{picture} \\
    \begin{tabular}{ | c | c | }
        \hline
        $e$ & $w(e)$ \\ \hline
        $a$ & $+1$   \\
        $b$ & $0$    \\
        $c$ & $-1$   \\
        $d$ & $+1$   \\ \hline
    \end{tabular}
    % \end{hbox}
    \caption{ Пример метаграфа. }\label{cycle_search}
\end{figure}

\begin{table}[H]
    \centering
    \begin{tabular}{ | c | c | c | c | c | }
        \hline
        $g = 0$            & $g = 1$           & $g = 2$           & $g = 3$           & $g = 4$            \\ \hline
        $(0, v_1, 0, nil)$ & $(1, v_3,  1, a)$ & $(2, v_2,  2, c)$ & $(3, v_4,  3, a)$ & $(3, v_1,  3, b)$  \\ \hline
                           & $(1, v_4,  0, b)$ & $(2, v_2,  5, d)$ & $(3, v_3,  4, c)$ & $(3, v_1,  3, a)$  \\ \hline
    \end{tabular}
    \caption{ Множество меток, сгенерированное в процессе работы алгоритма поиска цикла на метаграфе. }
    \label{cycle_search_mod_table}
\end{table}

\begin{figure}[H]
    \centering
    \begin{picture}(420,200)
        \put(35,165){\thicklines{\circle*{5}}}
        \put(65,165){\thicklines{\circle*{5}}}
        \put(35,35){\thicklines{\circle*{5}}}
        \put(65,35){\thicklines{\circle*{5}}}

        \bezier{300}(35,165)(70,100)(105,35)
        \bezier{300}(65,165)(100,100)(135,35)
        \bezier{300}(35,165)(50,100)(65,35)

        \put(105,165){\thicklines{\circle*{5}}}
        \put(135,165){\thicklines{\circle*{5}}}
        \put(105,35){\thicklines{\circle*{5}}}
        \put(135,35){\thicklines{\circle*{5}}}

        \bezier{300}(105,165)(140,100)(175,35)
        \bezier{300}(105,165)(120,100)(135,35)
        \bezier{300}(205,165)(155,100)(105,35)


        \put(175,165){\thicklines{\circle*{5}}}
        \put(205,165){\thicklines{\circle*{5}}}
        \put(175,35){\thicklines{\circle*{5}}}
        \put(205,35){\thicklines{\circle*{5}}}

        \bezier{300}(205,165)(240,100)(275,35)
        \bezier{300}(275,165)(225,100)(175,35)


        \put(245,165){\thicklines{\circle*{5}}}
        \put(275,165){\thicklines{\circle*{5}}}
        \put(245,35){\thicklines{\circle*{5}}}
        \put(275,35){\thicklines{\circle*{5}}}

        \bezier{300}(245,165)(280,100)(315,35)
        \bezier{300}(275,165)(310,100)(345,35)
        \bezier{300}(245,165)(260,100)(275,35)


        \put(315,165){\thicklines{\circle*{5}}}
        \put(345,165){\thicklines{\circle*{5}}}
        \put(315,35){\thicklines{\circle*{5}}}
        \put(345,35){\thicklines{\circle*{5}}}

        \bezier{300}(315,165)(350,100)(385,35)
        \bezier{300}(315,165)(330,100)(345,35)
        \bezier{300}(415,165)(365,100)(315,35)


        \put(385,165){\thicklines{\circle*{5}}}
        \put(415,165){\thicklines{\circle*{5}}}
        \put(385,35){\thicklines{\circle*{5}}}
        \put(415,35){\thicklines{\circle*{5}}}

        \thicklines
        \bezier{600}(385,165)(215,70)(35,35)
        \bezier{300}(135,165)(85,100)(35,35)
        \bezier{300}(135,165)(170,100)(205,35)
        \bezier{300}(175,165)(190,100)(205,35)
        \bezier{300}(175,165)(210,100)(245,35)
        \bezier{300}(345,165)(295,100)(245,35)
        \bezier{300}(345,165)(380,100)(415,35)
        \bezier{300}(385,165)(400,100)(415,35)
        \thinlines

        \bezier{600}(415,165)(245,70)(65,35)
        \bezier{600}(65,165)(225,130)(385,35)

    \end{picture}
    \caption{ 6-расширение метаграфа. }\label{cycle_search_expanded}
\end{figure}

\textbf{Замечание.}

%TODO

О двух видах циклов: которые зависят от $r$ и которые не зависят.

\pagebreak

\section{Построение графов с заданным обхватом}

Пусть $G(A \cup B, E, w)$ ~-- метаграф $w(e_i) = x_i \forall i = 0..|E|$.

Для каждой пары вершин $a$ и $v$, таких что $a \in A$ и $v \in V$, рассмотрим все неравенства вида $ch(\eta) \neq ch(\mu)$ Где $\eta$ и $\mu$ ~-- различные пути из $a$ в $v$, одинаковой длины не большей некоторого заданного значения $l \in N$.

Систему, содержащую все такие неравенств представим в виде (1).

\begin{equation}
    \centering
    \left\{
        \begin{array}{ll}
            a_{1,1} x_1 + ... + a_{1,e} x_e + b &\neq 0\\
            ...\\
            a_{l,1} x_1 + ... + a_{l,1} x_e + b &\neq 0\\
        \end{array}
    \right.
    \label{eqs:example}
\end{equation}

Пусть $G$ ~-- некоторый метаграф. Тогда справедлива следующая теорема.

\textbf{Теорема 5.}

Для $G$ существует расширение с обхватом большим $2l$  тогда и только тогда, когда система неравенств (1) для графа $G$ совместна.

\textbf{Доказательство.}

Из теоремы 4 следует, что характеристики путей, начинающихся и заканчивающихся в одной вершине равны, тогда и только тогда, когда они образуют цикл. Следовательно, при построении системы (1) исчерпываются все пары путей, которые могли бы образовать цикл. Таким образом существование решения системы (1) эквивалентно существованию расширения с обхватом большим, чем удвоенная длина максимального пути.

\qed

Для построения системы вида \ref{eqs:example} для заданного метаграфа $G$ можно воспользоваться следующим алгоритмом, являющимся модификацией\\ Алгоритма 1.

\textbf{Алгоритм 2.}

Пусть $G(A \cup B, E, f, w)$ ~-- метаграф причём $w(e_i) = x_i \forall i = 0..|E|$.

Для каждой вершины $a \in A$:

\begin{itemize}
    \item Добавим метку $(0, a, 0, nil)$ в пустое множество всех меток
    \item В цикле по поколениям $g$ от $1$ до $l / 2$:
    \begin{itemize}
        \item Для всех меток вида $(g - 1, v, ch, p)$:
        \item
            Для каждой дуги $e \not= p$ инцидентной вершине $v$,
            формируем метку $(g, v', ch', e)$, где $ch' = ch + (-1)^{g} w(e)$, $v'$ ~-- вершина отличная от $v$, инцидентная $e$.
            Добавляем эту метку ко множеству всех меток.
    \end{itemize}
    \item Добавляем в систему, все неравенства вида, $ch_1 \neq \ch_2$ для всех пар меток с совпадающими вершинами и поколениями.
\end{itemize}

\textbf{Пример.}

\begin{figure}[H]
    \centering
    \begin{picture}(150,200)
        \put(75,165){\thicklines{\circle*{5}}}
        \put(70,170){$v_1$}
    
        \put(35,35){\thicklines{\circle*{5}}}
        \put(30,20){$v_2$}
    
        \put(115,35){\thicklines{\circle*{5}}}
        \put(110,20){$v_3$}
    
        \bezier{300}(75,165)(10,100)(35,35)
        \put(5,100){$x_1$}

        \bezier{300}(75,165)(56,100)(35,35)
        \put(56,80){$x_2$}
    
        \bezier{300}(75,165)(140,100)(115,35)
        \put(125,100){$x_3$}

        \bezier{300}(75,165)(94,100)(115,35)
        \put(87,80){$x_4$}
    \end{picture}
    \caption{ Метаграф, дуги которого имеют весе, заданные переменными $x_1, x_2, x_3, x_4$. }
    \label{neq_system}
\end{figure}

\begin{table}[H]
    \centering
    \begin{tabular}{ | c | c | c | }
        \hline
        $g = 0$            & $g = 1$               & $g = 2$                   \\ \hline
        $(0, v_1, 0, nil)$ & $(1, v_2,  x_1, e_1)$ & $(2, v_1,  x_1 - x_2, b)$ \\ \hline
                           & $(1, v_2,  x_2, e_2)$ & $(2, v_1,  x_2 - x_1, a)$ \\ \hline
                           & $(1, v_3,  x_3, e_3)$ & $(2, v_1,  x_3 - x_4, e)$ \\ \hline
                           & $(1, v_3,  x_4, e_4)$ & $(2, v_1,  x_4 - x_3, d)$ \\ \hline
    \end{tabular}
    \caption{ Множество меток, сгенерированное в процессе работы алгоритма построения системы уравнений. }
    \label{cycle_search_table_neq}
\end{table}

\begin{equation}
    \centering
    \left\{
        \begin{array}{ll}
            x_1 - x_2 &\neq 0\\
            x_3 - x_4 &\neq 0\\
            2 x_1 - 2 x_2 &\neq 0\\
            2 x_3 - 2 x_4 &\neq 0\\
            x_1 - x_2 - x_3 + x_4 &\neq 0\\
            x_1 - x_2 + x_3 - x_4 &\neq 0\\
        \end{array}
    \right.
    % \caption{ Система уравнений, построенная алгоритмом 2. }
    \label{eqs:cycle_search_neqs}
\end{equation}

\section{Решение систем не равенств}

Поиск минимального решения для систем неравенств вида (\ref{eqs:example}), представленных в прошлой главе представляется вычислительно трудной задачей. Она предполагает перебор всех возможных решений с выбором минимального. Однако некоторое решение можно найти, воспользовавшись следующим алгоритмом.

\textbf{Алгоритм 3.}

\begin{enumerate}
    \item $e$ ~-- количество неизвестных в системе неравенств.
    \item Если в системе содержится неравенство вида $0 \neq 0$, то система не имеет решений, алгоритм завершается, сообщая, что решений нет.
    \item Найдём все неравенства вида $a x_e + b \neq 0$. Обозначим множество таких неравенств $I$.
    \item Выберем число $v$ такое, что $v \neq -b/a \forall a x_e + b \in I$, если $I = \varnothing$, то положим $v = 0$. Такое число можно найти, так как неравенств конечное количество. В результате этой замены не возникнет неравенства вида $0 \neq 0$ по условию выбора $v$.
    \item Заменим во всех неравенствах $x_e$ на $v$ и добавим в решение элемент $x_e = v$.
    \item Если $e = 1$ ~-- завершим работу алгоритма.
    \item Положим $e = e - 1$ переменной и вернёмся на шаг 3.
\end{enumerate}

\textbf{Пример.}

Положим $x_1 = 0$, подставим в систему не равенств, получим:

\begin{equation}
    \centering
    \left\{
        \begin{array}{ll}
            - x_2 &\neq 0\\
            x_3 - x_4 &\neq 0\\
            - 2 x_2 &\neq 0\\
            - 2 x_4 &\neq 0\\
            - x_2 - x_3 + x_4 &\neq 0\\
            - x_2 + x_3 - x_4 &\neq 0\\
        \end{array}
    \right.
    \label{eqs:cycle_search_neqs}
\end{equation}

$x_2$ не может быть равно $0$, т.к. в таком случае нарушается неравенство $- x_2 \neq 0$. Положим $x_2 = 1$, подставим в систему не равенств, получим:

\begin{equation}
    \centering
    \left\{
        \begin{array}{ll}
            - 1 &\neq 0\\
            x_3 - x_4 &\neq 0\\
            - 2 &\neq 0\\
            - 2 x_4 &\neq 0\\
            - 1 - x_3 + x_4 &\neq 0\\
            - 1 + x_3 - x_4 &\neq 0\\
        \end{array}
    \right.
    \label{eqs:cycle_search_neqs}
\end{equation}

Положим $x_3 = 0$, подставим в систему не равенств, получим:

\begin{equation}
    \centering
    \left\{
        \begin{array}{ll}
            - 1 &\neq 0\\
            - x_4 &\neq 0\\
            - 2 &\neq 0\\
            - 2 x_4 &\neq 0\\
            - 1 + x_4 &\neq 0\\
            - 1 - x_4 &\neq 0\\
        \end{array}
    \right.
    \label{eqs:cycle_search_neqs}
\end{equation}

$x_4$ не может принимать значения $0, 1, -1$, т.к. в таком случае нарушаются неравенства. Положим $x_4 = 2$, подставим в систему не равенств, получим:

\begin{equation}
    \centering
    \left\{
        \begin{array}{ll}
            - 1 &\neq 0\\
            - 2 &\neq 0\\
            - 2 &\neq 0\\
            - 4 &\neq 0\\
            1 &\neq 0\\
            - 3 &\neq 0\\
        \end{array}
    \right.
    \label{eqs:cycle_search_neqs}
\end{equation}

Полученные не равенства показывают, что $r$ не может принимать значения $1, 2, 3, 4$, следовательно минимально допустимое значение $r$ ~-- $5$. 5-расширение метаграфа с весами, полученными в ходе решения системы не равенств изображено на рис. \ref{neq_system_res}.

\begin{figure}[H]
    \centering
    \begin{picture}(380,200)
        \put(50,165){\thicklines{\circle*{5}}}
        \put(35,35){\thicklines{\circle*{5}}}
        \put(65,35){\thicklines{\circle*{5}}}
    
        \bezier{300}(50,165)(42,100)(35,35)
        \bezier{300}(50,165)(57,100)(65,35)


        \put(120,165){\thicklines{\circle*{5}}}
        \put(105,35){\thicklines{\circle*{5}}}
        \put(135,35){\thicklines{\circle*{5}}}

        \bezier{300}(120,165)(127,100)(135,35)
        \bezier{300}(120,165)(197,100)(275,35)

        \put(190,165){\thicklines{\circle*{5}}}
        \put(175,35){\thicklines{\circle*{5}}}
        \put(205,35){\thicklines{\circle*{5}}}

        \bezier{300}(190,165)(217,100)(245,35)
        \bezier{300}(190,165)(267,100)(345,35)

        \put(260,165){\thicklines{\circle*{5}}}
        \put(245,35){\thicklines{\circle*{5}}}
        \put(275,35){\thicklines{\circle*{5}}}

        \bezier{300}(260,165)(252,100)(245,35)
        \bezier{300}(260,165)(267,100)(275,35)
        \bezier{300}(260,165)(287,100)(315,35)
        \bezier{600}(260,165)(172,50)(65,35)

        \put(330,165){\thicklines{\circle*{5}}}
        \put(315,35){\thicklines{\circle*{5}}}
        \put(345,35){\thicklines{\circle*{5}}}

        \bezier{300}(330,165)(322,100)(315,35)
        \bezier{300}(330,165)(337,100)(345,35)
        \bezier{600}(330,165)(182,150)(35,35)
        \bezier{600}(330,165)(242,50)(135,35)

        \thicklines
        \bezier{300}(50,165)(77,100)(105,35)
        \bezier{300}(120,165)(112,100)(105,35)
        \bezier{300}(120,165)(147,100)(175,35)
        \bezier{300}(190,165)(182,100)(175,35)
        \bezier{300}(190,165)(197,100)(205,35)
        \bezier{300}(50,165)(127,100)(205,35)
    \end{picture}
    \caption{ Расширение метаграфа с весами дуг, полученными решением системы не равенств. }
    \label{neq_system_res}
\end{figure}

\textbf{Замечание.}

Результатом работы алгоритма поиска решения системы неравенств не обязательно будет минимальное решение.

% Пример

\section{Оценка работы алгоритма}

Описанный выше алгоритм построения графов с заданным обхватом не обязательно порождает решения с минимальным количеством вершин.

% Пример?

С увеличением требуемого обхвата количество вершин у результирующего графа растёт очень быстро.

Для метаграфа $G(V, E, w, f)$, количество вершин можно оценить снизу числом $  $ % Надо вспомнить, каким числом мы его оценивали

\textbf{Доказательство.}

% Оценки сверху мы, кажется, никакой не давали

% три пути, смотреть скриншот

% Надо дать оценки r

\begin{table}[H]
    \centering
    \begin{tabular}{ | c | c | c | c | c | }
        \hline
                   & $|i| = 9$         & $|i| = 15$        & $|i| = 27$      & $|i| = 45$  \\ \hline
        $ l = 6 $  & 108               & 315               & 1'053           & 2'970       \\ \hline
        $ l = 8 $  & 612               & 3'045             & 18'603          & 88'110      \\ \hline
        $ l = 10 $ & 8'766             & 77'385            & 889'434         & 7'181'955   \\ \hline
        $ l = 12 $ & 52'614            & 830'865           & 18'053'334      &             \\ \hline
    \end{tabular}
    \caption{ Множество меток, сгенерированное в процессе работы алгоритма поиска цикла на метаграфе. }
    \label{cycle_search_table}
\end{table}

\begin{table}[H]
    \centering
    \begin{tabular}{ | c | c | c | c | c | }
        \hline
                   & $|i| = 9$         & $|i| = 15$        & $|i| = 27$      & $|i| = 45$  \\ \hline
        $ l = 6 $  & 78               & 138               & 234           & 408       \\ \hline
        $ l = 8 $  & 432               & 624             & 1'776          & 4'464      \\ \hline
        $ l = 10 $ & 3'530             & 14'160            & 65'320         & 265'010   \\ \hline
        $ l = 12 $ & 14'016             & 106'068            & 998'124          &             \\ \hline
    \end{tabular}
    \caption{ Множество меток, сгенерированное в процессе работы алгоритма поиска цикла на метаграфе. }
    \label{cycle_search_table}
\end{table}

%=======================
\newpage

\addcontentsline{toc}{section}{Литература}
\renewcommand{\refname}{\centering \textbf{Литература}}

\begin{thebibliography}{0}

\bibitem{zemor}
G. Zémor, On Expander Codes, IEEE Trans. on Information theory, IT-47
No 2, (2001) pp. 835–837.
  
\bibitem{johnson}
S.\,J. Johnson,
Introducing Low-Density Parity-Check Codes.
~-- University of Newcastle, Australia, 2006.

\bibitem{gallager}
R.\,G. Gallager,
Low-density parity-check codes
~-- IRE Transactions on Information Theory, 1962.

\bibitem{bruteforce}
Гурский С.\,С., Могилевская Н.\,С.
Задача генерации проверочных матриц ldpc-кодов.
~-- Ростов н/Д : Материалы конференции СИТО, 2021.

\bibitem{protographs}
J. Thorpe,
Low-density parity-check (LDPC) codes constructed from protographs.
~-- JPL, IPN Progress Rep., Aug. 2003, vol. 42–154.

\bibitem{metagraphs}
Арутюнов О.\,В.
Построение (m, n)-регулярных двудольных графов с наибольшим обхватом методом увеличения метаграфов.
~-- Ростов н/Д : Материалы конференции СИТО, 2021.

\bibitem{sidon}
J. Singer,
Perfect difference sets
~-- Brooklyn College, Brooklyn, N. Y, 1966.

\end{thebibliography}

\end{document}